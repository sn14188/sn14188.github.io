---
title: "pnpm과 하드/심볼릭 링크"
date: 2025-10-30
---
Node.js 프로젝트에서 대부분 패키지 매니저로 npm이나 yarn을 사용합니다. 이번 부트캠프를 통해 pnpm을 처음 알게 됐고 팀 프로젝트에서 잘 사용하고 있습니다.<br>
pnpm을 사용함으로써 전역 저장소에 패키지를 한 번만 저장해 공간을 절약할 수 있다고 배웠는데, 어떻게/왜 그런 것인지 궁금해 원리를 조금 더 들여다봤습니다.
<br><br>

## 패키지 매니저
어떤 소프트웨어를 어떤 버전으로 어디에 설치하고 유지할지를 대신 결정하고 실행해주는 자동화 도구입니다.<br>
npm과 yarn은 JavaScript/TypeScript 프로젝트에서 외부 라이브러리를 관리하는 도구이며, 기본적으로 다음 역할을 수행합니다.

- 패키지 설치: 패키지를 다운로드해 `node_modules/`에 넣고, `package.json`과 `lock` 파일을 업데이트합니다
  - `npm init`으로 `package.json`를 생성합니다 (아직 의존성 `dependencies`는 비어있습니다)
  - `npm install`로 `package.json`의 `dependencies`를 추가하며, `package-lock.json`를 생성해 정확한 버전을 기록합니다
- 의존성 해결: 추가한 패키지는 물론 그 패키지가 의존하는 패키지들을 전부 가져옵니다
- 버전 잠금: `package-lock.json`으로 정확한 버전들을 기록해 의존성 트리를 재현할 수 있게 합니다
- 스크립트 실행: `npm run build` 등 `package.json`에 스크립트를 정의해 실행할 수 있습니다

## pnpm
현대적 패키지 매니저인 Performant Node Package Manager는 Node.js 생태계를 위한 효율적인 패키지 매니저로, 하드 링크와 심볼릭 링크를 활용해 중복 설치를 최소화합니다.<br>
npm이나 yarn은 프로젝트별로 `node_modules/` 복사본을 통째로 넣어 여러 프로젝트가 같은 라이브러리를 쓰면 디스크 낭비가 발생합니다. 실제로 node_modules/ 폴더가 굉장히 크기 때문에, 특정 패키지를 검색하는 데에 리소스가 많이 쓰이고 아래 프로젝트 예시처럼 둘 이상의 동일한 패키지가 있는 경우 중복해서 저장해야 하기 때문에 리소스가 또 낭비될 수 있습니다.
```ts
meong-road
├── frontend
│   ├── package.json
│   └── node_modules
└── backend
    ├── package.json
    └── node_modules
```
이런 프로젝트들이 많다면 더욱 낭비일 것입니다.<br>
하지만 pnpm은 모든 패키지를 전역 저장소 한 곳에 한 번만 다운로드하며, 각 프로젝트에서는 그 저장소의 파일로 하드 링크를 걸고, 의존성 구조는 심볼릭 링크로 표현합니다.

## 하드 링크와 심볼릭 링크
### 하드 링크
파일의 실제 데이터를 공유하는 또 하나의 이름입니다.

- 원본 파일과 하드 링크는 같은 파일 데이터를 공유합니다
- 그래서 한쪽을 수정하면 다른 쪽도 그대로 바뀝니다
- 원본 파일이 삭제되거나 이동되더라도, 다른 링크가 남아있다면 파일 데이터에 접근할 수 있습니다

### 심볼릭 링크
다른 파일이나 폴더의 경로를 가리키는 포인터입니다.

- 원본 파일의 위치만을 저장합니다
- 원본 파일이 삭제되거나 이동되는 경우에는 사용이 불가능합니다

따라서 하드 링크는 동일한 파일을 여러 이름으로 참조하고 싶을 때, 심볼릭 링크는 복잡한 경로에 있는 파일을 참고하고 싶을 때 사용할 수 있습니다.
<br><br>

*출처:<br>
[1] pnpm 공식 문서 (["Symlinked node_modules structure"](https://pnpm.io/symlinked-node-modules-structure))<br>
[2] 이것이 취업을 위한 컴퓨터 과학이다, 강민철 저, 한빛미디어, 2024, p.235-236<br>
[3] 코드잇 FESI 11기 강의자료*
